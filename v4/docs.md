<!-- Code generated by gomarkdoc. DO NOT EDIT -->

# middleware

```go
import "github.com/wisdom-oss/microservice-middlewares/v4"
```

## Index

- [Constants](<#constants>)
- [Variables](<#variables>)
- [func ErrorHandler\(serviceName string, errors map\[string\]wisdomType.WISdoMError\) func\(http.Handler\) http.Handler](<#ErrorHandler>)


## Constants

<a name="ERROR_CHANNEL_NAME"></a>

```go
const ERROR_CHANNEL_NAME = "error-channel"
```

<a name="STATUS_CHANNEL_NAME"></a>

```go
const STATUS_CHANNEL_NAME = "status-channel"
```

## Variables

<a name="InvalidTypeProvided"></a>InvalidTypeProvided represents an internal error which is sent if an invalid type as been provided to the input channel of the error handler

```go
var InvalidTypeProvided = wisdomType.WISdoMError{
    Type:   "https://pkg.go.dev/github.com/wisdom-oss/microservice-middlewares/v4#InvalidTypeProvided",
    Status: 500,
    Title:  "Invalid Type Provided",
    Detail: "An invalid type has been provided to the error handler. Please contact your administrator",
}
```

<a name="ErrorHandler"></a>
## func ErrorHandler

```go
func ErrorHandler(serviceName string, errors map[string]wisdomType.WISdoMError) func(http.Handler) http.Handler
```

ErrorHandler allows the global handling and wrapping errors occurring in API calls. The function needs the service name as a parameter to correctly generate the error code used in the wisdomType.WISdoMError. Furthermore, it also accepts the usage of preregistered errors

To access the channel added to the request context in an http handler use the following call:

```
errorHandler := r.Context().Value("error-channel").(chan<- interface{})
```

To watch for the handling to be completed, use the following channel from the handler

```
errorHandled :=  r.Context().Value("status.channel").(<-chan bool)
```

To handle an error just send it into the error handler channel and listen on the statusChannel for a boolean return.

```
errorHandler <- errors.New("test error")
<-errorHandled
```

After handling the error it is recommended to exit the handler to hide errors and warnings about the http response writer being called when closed or tying to write headers again

Generated by [gomarkdoc](<https://github.com/princjef/gomarkdoc>)
